LOCAL_DIR := $(GET_LOCAL_DIR)
# List of features for this product
#FEATURE_FASTBOOT_EXTENSIONS := true
FEATURE_IDME := true

FEATURE_LIBTOMCRYPT := false
FEATURE_LIBTOMMATH := false
#FEATURE_LIFE_CYCLE_REASONS := true
FEATURE_LK_RAMDUMP := false

FEATURE_UNLOCK := true
# T22 porting TODO FEATURE_SECURE_FLASHING  := true
FEATURE_SECURE_FLASHING  := false
FEATURE_SECURE_BOOT := true
FEATURE_ONETIME_UNLOCK := true

UFBL_PROJ_SOPHIA := yes
export UFBL_PROJ_SOPHIA

DEFINES += UFBL_PLATFORM_MSTAR
DEFINES += CONFIG_USERDATA_IDME_ADDR=0x0
DEFINES += CONFIG_IDME_PARTITION_NUM=2
DEFINES += UFBL_PROJ_SOPHIA
DEFINES += UFBL_FEATURE_IDME
ifdef CONFIG_MSTAR_BD_M7322_WINSTON
DEFINES += IDME_NUM_OF_EMMC_BLOCKS=512
else
DEFINES += IDME_NUM_OF_EMMC_BLOCKS=256
endif
ifeq ($(FEATURE_SECURE_BOOT),true)
FEATURE_COMMON_OPENSSL := false
FEATURE_LIBTOMCRYPT := true
FEATURE_LIBTOMMATH := true
DEFINES += UFBL_FEATURE_SECURE_BOOT=1
DEFINES += BOARD_AMAZON_KERNEL_SIGNING
else
FEATURE_COMMON_OPENSSL := false
FEATURE_LIBTOMCRYPT := false
FEATURE_LIBTOMMATH := false
endif
ifeq ($(FEATURE_LIBTOMCRYPT),true)
DEFINES += MSTAR_SHA256_QUIRK
endif

ifeq ($(FEATURE_UNLOCK),true)
DEFINES += UFBL_FEATURE_UNLOCK
endif

ifeq ($(FEATURE_SECURE_FLASHING),true)
DEFINES += UFBL_FEATURE_SECURE_FLASHING
endif

ifeq ($(FEATURE_ONETIME_UNLOCK),true)
DEFINES += UFBL_FEATURE_ONETIME_UNLOCK
endif

DEFINES += IDME_UPDATE_TABLE=1

export UFBL_DEFINES := $(addprefix -D,$(DEFINES))
export FEATURE_LIBTOMCRYPT FEATURE_LIBTOMMATH FEATURE_SECURE_BOOT

# After defining list of features, include
# ufbl common definitions
include $(LOCAL_DIR)/ufbl_common_uboot.mk
